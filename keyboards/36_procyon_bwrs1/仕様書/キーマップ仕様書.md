# Guitar Procyon 36 キーマップ仕様書

## 概要
- **キーボード名**: Guitar Procyon 36 (MaxTouch版)
- **キー数**: 36キー（左右各18キー）
- **マイクロコントローラー**: RP2040
- **ポインティングデバイス**: MaxTouchデジタイザー（I2C通信）
- **RGBバックライト**: WS2812対応
- **エンコーダー**: 2個搭載

## レイヤー構成

### レイヤー一覧
- **`_BASE`**: 基本レイヤー（アルファベット、記号）
- **`_RAISE`**: 記号、数字（プログラミング記号強化）
- **`_MOUSE`**: マウス操作
- **`_LOWER`**: ファンクションキー、ナビゲーション
- **`_MEDIA`**: メディア制御
- **`_PROGRAM`**: プログラミング作業専用（新規追加）
- **`_ADJUST`**: RGB設定、特殊機能

### レイヤー切り替え方法
- **`_RAISE`レイヤー**: 左側の`MO(1)`キーを押す
- **`_MOUSE`レイヤー**: 右側の`MO(2)`キーを押す
- **`_LOWER`レイヤー**: `MO(1)`と`MO(2)`を同時に押す（一時的）
- **`_MEDIA`レイヤー**: `MO(1)`と`MO(2)`を同時に押す（一時的）
- **`_PROGRAM`レイヤー**: `MO(1)`と`MO(2)`を同時に押す（一時的）
- **`_ADJUST`レイヤー**: `MO(1)`と`MO(2)`を同時に押す（永続的）

### レイヤー別RGB色設定
| レイヤー | 色 | 説明 |
|---------|----|----|
| **`_BASE`** | 🟦 **シアン** | 基本レイヤー |
| **`_RAISE`** | 🟢 **緑** | 記号・数字（プログラミング記号強化） |
| **`_MOUSE`** | 🟣 **紫** | マウス操作 |
| **`_LOWER`** | 🔴 **赤** | ファンクションキー |
| **`_MEDIA`** | 🩷 **ピンク** | メディア制御 |
| **`_PROGRAM`** | 🔵 **青** | プログラミング作業専用 |
| **`_ADJUST`** | 🟠 **オレンジ** | RGB設定 |

### 色変更の仕組み
- **`layer_state_set_user`関数**: レイヤー変更時に自動実行
- **`layer_colors`配列**: 各レイヤーの色を定義
- **`rgb_matrix_sethsv`関数**: RGB色を設定

## 詳細キーマップ

### `_BASE`レイヤー（基本レイヤー）- 🟦 シアン
```
左側                   右側
┌─────┬─────┬─────┬─────┬─────┬─────┐    ┌─────┬─────┬─────┬─────┬─────┬─────┐
│ TAB │  Q  │  W  │  E  │  R  │  T  │    │  Y  │  U  │  I  │  O  │  P  │BSPC │
├─────┼─────┼─────┼─────┼─────┼─────┤    ├─────┼─────┼─────┼─────┼─────┼─────┤
│LCTL │  A  │  S  │  D  │  F  │  G  │    │  H  │  J  │  K  │  L  │  ;  │  '  │
├─────┼─────┼─────┼─────┼─────┼─────┤    ├─────┼─────┼─────┼─────┼─────┼─────┤
│LSFT │  Z  │  X  │  C  │  V  │  B  │    │  N  │  M  │  ,  │  .  │  /  │RSFT │
└─────┴─────┴─────┼─────┼─────┼─────┤    ├─────┼─────┼─────┼─────┴─────┴─────┘
                  │LGUI │LCTL │LGUI │MO(1)│ SPC │ ENT │MO(2)│BSPC │LALT │RGUI │
                  └─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┘
```

### `_LOWER`レイヤー（ファンクションキー）- 🔴 赤
```
左側                   右側
┌─────┬─────┬─────┬─────┬─────┬─────┐    ┌─────┬─────┬─────┬─────┬─────┬─────┐
│     │ F1  │ F2  │ F3  │ F4  │  -  │    │ INS │HOME │ UP  │ END │PGUP │BSPC │
├─────┼─────┼─────┼─────┼─────┼─────┤    ├─────┼─────┼─────┼─────┼─────┼─────┤
│LCTL │ F5  │ F6  │ F7  │ F8  │  =  │    │ DEL │LEFT │DOWN │RIGHT│PGDN │     │
├─────┼─────┼─────┼─────┼─────┼─────┤    ├─────┼─────┼─────┼─────┼─────┼─────┤
│LSFT │ F9  │ F10 │ F11 │ F12 │PAUSE│    │     │     │  [  │  ]  │  \  │RSFT │
└─────┴─────┴─────┼─────┼─────┼─────┤    ├─────┼─────┼─────┼─────┴─────┴─────┘
                  │     │     │LGUI │     │ SPC │ ENT │     │     │LALT │     │
                  └─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┘
```

### `_RAISE`レイヤー（記号、数字）- 🟢 緑
```
左側                   右側
┌─────┬─────┬─────┬─────┬─────┬─────┐    ┌─────┬─────┬─────┬─────┬─────┬─────┐
│CAPS │  !  │  "  │  #  │  ^  │     │    │  *  │  7  │  8  │  9  │  -  │BSPC │
├─────┼─────┼─────┼─────┼─────┼─────┤    ├─────┼─────┼─────┼─────┼─────┼─────┤
│LCTL │  {  │  }  │  (  │  )  │     │    │  /  │  4  │  5  │  6  │  +  │  '  │
├─────┼─────┼─────┼─────┼─────┼─────┤    ├─────┼─────┼─────┼─────┼─────┼─────┤
│LSFT │  [  │  ]  │  <  │  >  │  =  │    │  0  │  1  │  2  │  3  │  .  │RSFT │
└─────┴─────┴─────┼─────┼─────┼─────┤    ├─────┼─────┼─────┼─────┴─────┴─────┘
                  │     │     │LGUI │     │ SPC │ ENT │     │     │     │     │
                  └─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┘
```

### `_MOUSE`レイヤー（マウス操作）- 🟣 紫
```
左側                   右側
┌─────┬─────┬─────┬─────┬─────┬─────┐    ┌─────┬─────┬─────┬─────┬─────┬─────┐
│     │     │     │     │     │     │    │WH_UP│MS_UP│WH_DN│     │     │     │
├─────┼─────┼─────┼─────┼─────┼─────┤    ├─────┼─────┼─────┼─────┼─────┼─────┤
│     │     │     │     │     │     │    │MS_LT│MS_DN│MS_RT│     │     │     │
├─────┼─────┼─────┼─────┼─────┼─────┤    ├─────┼─────┼─────┼─────┼─────┼─────┤
│     │     │     │     │     │     │    │BTN1 │BTN2 │BTN3 │BTN4 │BTN5 │     │
└─────┴─────┴─────┼─────┼─────┼─────┤    ├─────┼─────┼─────┼─────┴─────┴─────┘
                  │     │     │LGUI │     │ SPC │ ENT │     │     │     │     │
                  └─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┘
```

### `_MEDIA`レイヤー（メディア制御）- 🩷 ピンク（新規追加）
```
左側                   右側
┌─────┬─────┬─────┬─────┬─────┬─────┐    ┌─────┬─────┬─────┬─────┬─────┬─────┐
│     │     │     │     │     │     │    │PLAY │NEXT │PREV │VOL+ │VOL- │MUTE │
├─────┼─────┼─────┼─────┼─────┼─────┤    ├─────┼─────┼─────┼─────┼─────┼─────┤
│     │     │     │     │     │     │    │BRT+ │BRT- │ZOOM+│ZOOM-│SPOT │DISC │
├─────┼─────┼─────┼─────┼─────┼─────┤    ├─────┼─────┼─────┼─────┼─────┼─────┤
│     │     │     │     │     │     │    │TERM │CALC │MAIL │COMP │SEARCH│HOME │
└─────┴─────┴─────┼─────┼─────┼─────┤    ├─────┼─────┼─────┼─────┴─────┴─────┘
                  │     │     │LGUI │     │ SPC │ ENT │     │     │     │     │
                  └─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┘
```

### `_ADJUST`レイヤー（RGB設定）- 🟠 オレンジ
```
左側                   右側
┌─────┬─────┬─────┬─────┬─────┬─────┐    ┌─────┬─────┬─────┬─────┬─────┬─────┐
│     │     │  @  │     │  $  │     │    │     │     │     │     │     │BSPC │
├─────┼─────┼─────┼─────┼─────┼─────┤    ├─────┼─────┼─────┼─────┼─────┼─────┤
│LCTL │     │  &  │  |  │  \  │     │    │     │     │     │     │  ~  │  `  │
├─────┼─────┼─────┼─────┼─────┼─────┤    ├─────┼─────┼─────┼─────┼─────┼─────┤
│LSFT │     │     │     │  %  │     │    │RGB_T│RGB_M│RGB_H│RGB_S│RGB_V│RSFT │
└─────┴─────┴─────┼─────┼─────┼─────┤    ├─────┼─────┼─────┼─────┴─────┴─────┘
                  │     │     │LGUI │     │ SPC │ ENT │     │     │LALT │     │
                  └─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┘
```

## プログラミング作業最適化機能

### 🆕 新規追加：`_PROGRAM`レイヤー
システムエンジニアのプログラミング作業に特化した専用レイヤーです。

#### **プログラミングレイヤーのキー配置**
```
┌─────────────────────────────────────────────────────────────┐
│ ESC  F1   F2   F3   F4   F5  │  F6   F7   F8   F9   F10  F12 │
├─────────────────────────────────────────────────────────────┤
│ TAB  COPY PASTE CUT  UNDO REDO│ FIND  REPL COMMENT SAVE SAVE_AS│
├─────────────────────────────────────────────────────────────┤
│ SHIFT NEW  OPEN CLOSE RUN  DEBUG│ GIT_ADD COMMIT PUSH PULL TERMINAL│
└─────────────────────────────────────────────────────────────┘
```

#### **プログラミング用カスタムキーコード**
| キー | 機能 | 説明 |
|------|------|------|
| **`KC_COPY`** | `Ctrl+C` | コピー |
| **`KC_PASTE`** | `Ctrl+V` | ペースト |
| **`KC_CUT`** | `Ctrl+X` | カット |
| **`KC_UNDO`** | `Ctrl+Z` | 元に戻す |
| **`KC_REDO`** | `Ctrl+Shift+Z` | やり直し |
| **`KC_FIND`** | `Ctrl+F` | 検索 |
| **`KC_REPLACE`** | `Ctrl+H` | 置換 |
| **`KC_COMMENT`** | `Ctrl+/` | コメントアウト |
| **`KC_SAVE`** | `Ctrl+S` | 保存 |
| **`KC_SAVE_AS`** | `Ctrl+Shift+S` | 名前を付けて保存 |
| **`KC_NEW_FILE`** | `Ctrl+N` | 新規ファイル |
| **`KC_OPEN_FILE`** | `Ctrl+O` | ファイルを開く |
| **`KC_CLOSE_FILE`** | `Ctrl+W` | ファイルを閉じる |
| **`KC_RUN_CODE`** | `Ctrl+F5` | コード実行 |
| **`KC_DEBUG`** | `Ctrl+F9` | デバッグ開始 |
| **`KC_GIT_ADD`** | `git add .` | Git追加 |
| **`KC_GIT_COMMIT`** | `git commit -m "` | Gitコミット |
| **`KC_GIT_PUSH`** | `git push` | Gitプッシュ |
| **`KC_GIT_PULL`** | `git pull` | Gitプル |

### 🔧 `_RAISE`レイヤーの強化
プログラミングでよく使用する記号を追加配置：

| 追加記号 | 説明 |
|----------|------|
| **`%`** | モジュロ演算子、パーセント |
| **`&`** | ビット演算子、参照演算子 |

### 🎯 エンコーダー設定（プログラミングレイヤー）
- **左エンコーダー**: `Undo` / `Redo`
- **右エンコーダー**: `Zoom Out` / `Zoom In`

## 横スクロール機能（新規追加）

### エンコーダー設定の更新
各レイヤーでエンコーダーが異なる機能を提供します：

| レイヤー | 左エンコーダー | 右エンコーダー |
|---------|---------------|---------------|
| **`_BASE`** | マウスホイール上下 | **横スクロール** |
| **`_RAISE`** | ズーム調整 | メディアトラック変更 |
| **`_MOUSE`** | **横スクロール** | 縦スクロール |
| **`_LOWER`** | 音量調整 | 画面明度調整 |
| **`_MEDIA`** | 音量調整 | メディアトラック変更 |
| **`_PROGRAM`** | **Undo** / **Redo** | **Zoom Out** / **Zoom In** |
| **`_ADJUST`** | RGB明度調整 | RGB色相調整 |

### 横スクロール機能の詳細
- **`_BASE`レイヤー**: 右エンコーダーで横スクロール
- **`_MOUSE`レイヤー**: 左エンコーダーで横スクロール
- **`KC_MS_WH_LEFT`**: 左スクロール
- **`KC_MS_WH_RIGHT`**: 右スクロール

## メディア制御機能（新規追加）

### `_MEDIA`レイヤーの機能
- **メディア制御**: 再生/一時停止、次のトラック、前のトラック
- **音量制御**: 音量増加、音量減少、ミュート
- **画面制御**: 明度増加、明度減少、ズーム増加、ズーム減少
- **アプリ起動**: Spotify、Discord、ターミナル、電卓、メール、エクスプローラー

### カスタムキーコード
- **`KC_ZOOM_IN`**: Ctrl + = (ズームイン)
- **`KC_ZOOM_OUT`**: Ctrl + - (ズームアウト)
- **`KC_BRIGHT_UP`**: Ctrl + ↑ (明度増加)
- **`KC_BRIGHT_DOWN`**: Ctrl + ↓ (明度減少)
- **`KC_SPOTIFY`**: Win + R → spotify
- **`KC_DISCORD`**: Win + R → discord
- **`KC_TERMINAL`**: Win + R → cmd

## マウス操作機能

### `_MOUSE`レイヤーの機能
- **マウス移動**: カーソル上下左右移動
- **マウスクリック**: 左クリック、右クリック、中クリック
- **マウスボタン**: サイドボタン1、2
- **スクロール**: ホイール上下スクロール

### マウス操作の使用方法
1. **`_MOUSE`レイヤーにアクセス**: `MO(1)`と`MO(2)`を同時に押す
2. **マウス移動**: 右側のキーでマウスカーソルを移動
3. **クリック**: 右側のキーでマウスボタンを操作
4. **スクロール**: 右側のキーでホイールスクロール

## RGB制御キー

### `_ADJUST`レイヤーでのRGB制御
- **`RGB_TOG`**: RGBバックライトのオン/オフ切り替え
- **`RGB_MOD`**: アニメーションモード変更
- **`RGB_HUI`**: 色相増加
- **`RGB_SAI`**: 彩度増加
- **`RGB_VAI`**: 明度増加

### デフォルトRGB設定
- **色相**: 200（シアン色）
- **アニメーション**: breathing（呼吸効果）

## エンコーダー設定

### エンコーダー機能
- **左エンコーダー**: マウスホイール上下
- **右エンコーダー**: 音量調整

### レイヤー別エンコーダー動作
- **`_BASE`レイヤー**: マウスホイール・**横スクロール**
- **`_RAISE`レイヤー**: ズーム調整・メディアトラック変更
- **`_MOUSE`レイヤー**: **横スクロール**・縦スクロール
- **`_LOWER`レイヤー**: 音量調整・画面明度調整
- **`_MEDIA`レイヤー**: 音量調整・メディアトラック変更
- **`_PROGRAM`レイヤー**: **Undo** / **Redo**
- **`_ADJUST`レイヤー**: RGB明度調整・RGB色相調整

## 特殊機能

### 分割キーボード設定
- **左右判定ピン**: GP29
- **シリアル通信**: GP0/GP1
- **I2C通信**: GP2/GP3（MaxTouch用）

### ブートローダー進入方法
1. **ブートマジックリセット**: 左上のキーを押しながらキーボードを接続
2. **物理リセットボタン**: PCB背面のボタンを短時間押す
3. **キーコード**: `QK_BOOT`がマップされているキーを押す

## 右側キーボード接続時の設定

### 🔧 右側キーボード接続時の最適化設定

#### **接続方法**
1. **右側キーボードのみをUSBケーブルでPCに接続**
2. **左側キーボードは右側とTRRSケーブルで接続**
3. **Windowsが自動的にキーボードを認識**

#### **自動設定項目**
- **マスター設定**: 右側が自動的にマスターとして動作
- **タッチパッド**: 右側のタッチパッドが有効化
- **RGB制御**: 右側からRGBバックライトを制御
- **レイヤー切り替え**: 右側のキーでレイヤー切り替え

#### **Windows接続時の最適化**
| 設定項目 | 値 | 説明 |
|----------|----|----|
| **USBポーリング間隔** | 1ms | 応答性向上 |
| **NKRO** | 強制有効 | 同時押し対応 |
| **スキャン効率** | 4キー/スキャン | 処理速度向上 |
| **USB接続タイムアウト** | 2秒 | 接続安定性向上 |

#### **レイヤー切り替えの安定性向上**
| 設定項目 | 値 | 説明 |
|----------|----|----|
| **タップ判定時間** | 200ms | タップ/ホールド判定の精度向上 |
| **モッドタップ割り込み** | 無視 | レイヤー切り替えの安定性向上 |
| **パーミッシブホールド** | 有効 | より自然なキー操作 |

#### **初期化処理**
1. **起動時安定化待機**: 100ms
2. **RGB初期化**: デフォルトレイヤー色（シアン）
3. **タッチパッド初期化**: 右側タッチパッドの準備完了
4. **レイヤー状態確認**: 全レイヤーの正常動作確認

### 🎯 右側キーボード接続時の利点

#### **プログラミング作業での利点**
- **タッチパッド操作**: 右側のタッチパッドでカーソル移動
- **エンコーダー操作**: 右側のエンコーダーでスクロール・調整
- **レイヤー切り替え**: 右側のキーで素早いレイヤー切り替え
- **RGB視認性**: 右側からRGB状態を確認

#### **Windowsでの動作保証**
- **プラグ&プレイ**: 接続即座に動作開始
- **ドライバー不要**: 標準HIDキーボードとして認識
- **VIA/Vial対応**: ブラウザ経由での設定変更可能
- **ファームウェア更新**: 右側からファームウェア更新可能

## カスタマイズ可能項目

### レイヤー色の変更
```c
// レイヤーごとのRGB色定義を変更
const HSV layer_colors[] = {
    [_BASE]  = {HSV_BLUE},      // 青に変更
    [_LOWER] = {HSV_YELLOW},    // 黄に変更
    [_RAISE] = {HSV_PINK},      // ピンクに変更
    [_MOUSE] = {HSV_TEAL},      // ティールに変更
    [_MEDIA] = {HSV_WHITE},     // 白に変更
    [_PROGRAM] = {HSV_BLUE},   // 青に変更
    [_ADJUST] = {HSV_ORANGE}    // オレンジに変更
};
```

### 追加可能なRGB制御キー
```c
RGB_HUD,  // 色相減少
RGB_SAD,  // 彩度減少  
RGB_VAD,  // 明度減少
RGB_SPI,  // アニメーション速度増加
RGB_SPD,  // アニメーション速度減少
```

### 追加可能なマウスキー
```c
KC_MS_ACCEL0,  // マウス加速レベル0
KC_MS_ACCEL1,  // マウス加速レベル1
KC_MS_ACCEL2,  // マウス加速レベル2
```

### 追加可能な機能キー
```c
QK_BOOT,  // ブートローダー進入
KC_LOCK,  // キーボードロック
KC_SLEP,  // スリープ
```

---

**作成日**: 2025年8月4日  
**バージョン**: 1.4（横スクロール機能・メディアレイヤー追加）  
**作成者**: QMK Firmware 