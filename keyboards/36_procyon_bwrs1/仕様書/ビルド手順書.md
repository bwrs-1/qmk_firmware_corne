# Guitar Procyon 36 ビルド手順書

## 概要
このドキュメントでは、Guitar Procyon 36キーボード（MaxTouch版）のファームウェアをビルドし、キーボードにフラッシュする手順を説明します。

## 前提条件

### 必要なソフトウェア
1. **QMK CLI** - QMKファームウェアのビルドツール
2. **Python 3.7以上** - QMK CLIの実行に必要
3. **Git** - ソースコードの取得に必要

### 開発環境のセットアップ

#### 1. QMK CLIのインストール
```bash
# Windows (PowerShell)
pip3 install qmk

# macOS
brew install qmk/qmk/qmk

# Linux
pip3 install qmk
```

#### 2. QMKファームウェアのクローン
```bash
git clone https://github.com/qmk/qmk_firmware.git
cd qmk_firmware
```

#### 3. 開発環境のセットアップ
```bash
qmk setup
```

## ビルド手順

### 1. ビルド環境の確認
```bash
# QMK CLIのバージョン確認
qmk --version

# ビルド環境の確認
qmk doctor
```

### 2. ファームウェアのビルド

#### 基本的なビルドコマンド
```bash
# デフォルトキーマップでビルド
make 36_procyon_bwrs1/guitar_procyon36:default

# または QMK CLIを使用
qmk compile -kb 36_procyon_bwrs1/guitar_procyon36 -km default
```

#### ビルドオプション
```bash
# デバッグ情報付きでビルド
make 36_procyon_bwrs1/guitar_procyon36:default DEBUG=1

# サイズ最適化でビルド
make 36_procyon_bwrs1/guitar_procyon36:default LTO_ENABLE=yes

# 特定の機能を無効化してビルド
make 36_procyon_bwrs1/guitar_procyon36:default RGB_MATRIX_ENABLE=no
```

### 3. ビルド結果の確認
ビルドが成功すると、以下のファイルが生成されます：
- `36_procyon_bwrs1_guitar_procyon36_default.uf2` - フラッシュ用ファイル

## フラッシュ手順

### 1. ブートローダーモードへの進入

#### 方法1: ブートマジックリセット
1. キーボードの電源を切る
2. 左上のキー（TABキー）を押し続ける
3. キーボードをUSBケーブルで接続
4. キーを離す

#### 方法2: 物理リセットボタン
1. PCB背面のリセットボタンを短時間押す
2. または、リセット用のパッドを短絡する

#### 方法3: キーコード（設定されている場合）
1. `QK_BOOT`がマップされているキーを押す

### 2. フラッシュの実行

#### 自動フラッシュ（推奨）
```bash
# ビルドとフラッシュを同時実行
make 36_procyon_bwrs1/guitar_procyon36:default:flash

# または QMK CLIを使用
qmk flash -kb 36_procyon_bwrs1/guitar_procyon36 -km default
```

#### 手動フラッシュ
1. ブートローダーモードでキーボードを接続
2. 生成された`.uf2`ファイルをキーボードのドライブにコピー
3. キーボードが自動的に再起動

### 3. フラッシュ後の確認
1. キーボードが正常に認識されることを確認
2. 各キーが正しく動作することを確認
3. RGBバックライトが動作することを確認
4. エンコーダーが動作することを確認
5. MaxTouchデジタイザーが動作することを確認

## トラブルシューティング

### よくある問題と解決方法

#### 1. ビルドエラー
```bash
# 依存関係の確認
qmk doctor

# キャッシュのクリア
make clean

# 再ビルド
make 36_procyon_bwrs1/guitar_procyon36:default
```

#### 2. フラッシュエラー
- **ブートローダーモードが進入できない**
  - 物理リセットボタンを確認
  - 別のUSBケーブルを試す
  - 別のUSBポートを試す

- **フラッシュ後にキーボードが動作しない**
  - ブートローダーモードで再度フラッシュ
  - 正しいファームウェアファイルを使用しているか確認

#### 3. 機能が動作しない
- **RGBバックライトが点灯しない**
  - `_ADJUST`レイヤーで`RGB_TOG`を押してON/OFFを切り替え
  - ファームウェアでRGB機能が有効になっているか確認

- **エンコーダーが動作しない**
  - エンコーダーの配線を確認
  - ファームウェアでエンコーダー機能が有効になっているか確認

- **MaxTouchデジタイザーが動作しない**
  - I2C通信の配線を確認（GP2/GP3）
  - ファームウェアでデジタイザー機能が有効になっているか確認

## カスタマイズ

### キーマップの変更
1. `keyboards/36_procyon_bwrs1/guitar_procyon36/keymaps/default/keymap.c`を編集
2. 変更後、再ビルドとフラッシュを実行

### 設定の変更
1. `keyboards/36_procyon_bwrs1/guitar_procyon36/config.h`を編集
2. 変更後、再ビルドとフラッシュを実行

### 新しいキーマップの作成
```bash
# 新しいキーマップを作成
qmk new-keymap -kb 36_procyon_bwrs1/guitar_procyon36 -km my_keymap

# 新しいキーマップでビルド
make 36_procyon_bwrs1/guitar_procyon36:my_keymap
```

## 参考情報

### 関連ドキュメント
- [QMK公式ドキュメント](https://docs.qmk.fm/)
- [QMK新手指南](https://docs.qmk.fm/#/newbs)
- [QMK設定ガイド](https://docs.qmk.fm/#/config_options)

### サポート
- [QMK Discord](https://discord.gg/Uq7gcHh)
- [QMK GitHub Issues](https://github.com/qmk/qmk_firmware/issues)

---

**作成日**: 2025年8月4日  
**バージョン**: 1.0  
**作成者**: QMK Firmware 