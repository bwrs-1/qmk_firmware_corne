# QMK開発環境構築手順書

## 概要
このドキュメントでは、Guitar Procyon 36キーボードのファームウェア開発に必要な環境構築手順を説明します。

## 必要なソフトウェア

### 1. Python
- **バージョン**: 3.7以上（推奨: 3.11以上）
- **ダウンロード**: [python.org](https://www.python.org/downloads/)
- **インストール時**: "Add Python to PATH"にチェック

### 2. MSYS2
- **バージョン**: 最新版
- **ダウンロード**: [msys2.org](https://www.msys2.org/)
- **インストール先**: `C:\msys64`（推奨）

### 3. Git
- **バージョン**: 最新版
- **ダウンロード**: [git-scm.com](https://git-scm.com/)
- **インストール時**: デフォルト設定でOK

## 環境構築手順

### Step 1: Pythonのインストール
1. [python.org](https://www.python.org/downloads/)からPythonをダウンロード
2. インストーラーを実行
3. "Add Python to PATH"にチェック
4. インストール完了後、コマンドプロンプトで確認：
   ```bash
   python --version
   pip --version
   ```

### Step 2: MSYS2のインストール
1. [msys2.org](https://www.msys2.org/)からMSYS2をダウンロード
2. インストーラーを実行（`C:\msys64`にインストール）
3. インストール完了後、MSYS2 MinGW 64-bitを起動
4. パッケージの更新：
   ```bash
   pacman -Syu
   ```
5. 必要なパッケージをインストール：
   ```bash
   pacman -S git make python3 pip
   ```

### Step 3: QMK CLIのインストール
1. MSYS2 MinGW 64-bitターミナルを開く
2. QMK CLIをインストール：
   ```bash
   pip3 install qmk
   ```
3. インストール確認：
   ```bash
   qmk --version
   ```

### Step 4: QMKファームウェアのセットアップ
1. QMKファームウェアをクローン：
   ```bash
   git clone https://github.com/qmk/qmk_firmware.git
   cd qmk_firmware
   ```
2. QMK開発環境をセットアップ：
   ```bash
   qmk setup
   ```
3. セットアップ確認：
   ```bash
   qmk doctor
   ```

## ビルド環境の確認

### 環境チェック
```bash
# QMK環境の診断
qmk doctor

# 必要なツールの確認
qmk list-keyboards | grep procyon
```

### 期待される出力
```
✅ Found 36_procyon_bwrs1/guitar_procyon36
```

## ビルド手順

### 基本的なビルド
```bash
# デフォルトキーマップでビルド
qmk compile -kb 36_procyon_bwrs1/guitar_procyon36 -km default

# または makeコマンドを使用
make 36_procyon_bwrs1/guitar_procyon36:default
```

### ビルドとフラッシュ
```bash
# ビルドとフラッシュを同時実行
qmk flash -kb 36_procyon_bwrs1/guitar_procyon36 -km default

# または makeコマンドを使用
make 36_procyon_bwrs1/guitar_procyon36:default:flash
```

## トラブルシューティング

### よくある問題

#### 1. QMK CLIが見つからない
```bash
# パスの確認
echo $PATH

# QMKの再インストール
pip3 uninstall qmk
pip3 install qmk
```

#### 2. MSYS2環境の問題
```bash
# MSYS2の更新
pacman -Syu

# 必要なパッケージの再インストール
pacman -S git make python3 pip
```

#### 3. ビルドエラー
```bash
# 環境の診断
qmk doctor

# キャッシュのクリア
qmk clean
```

#### 4. タッチパッドの問題
```bash
# デバッグ情報の確認
# config.hで MAXTOUCH_DEBUG = yes に設定
# シリアルモニターでデバッグ情報を確認
```

## 開発ツール

### 推奨エディタ
- **Visual Studio Code**: QMK拡張機能付き
- **Sublime Text**: 軽量で高速
- **Vim/Emacs**: 上級者向け

### 便利なツール
- **QMK Configurator**: [config.qmk.fm](https://config.qmk.fm/)
- **VIA**: [usevia.app](https://usevia.app)
- **Vial**: [vial.rocks](https://vial.rocks)

## デバッグ方法

### シリアルモニター
```bash
# シリアルモニターの起動
qmk console

# または PuTTY を使用
# ポート: COM3（例）
# 速度: 115200
```

### ログ出力
```c
// keymap.cでログ出力
#include "print.h"

void keyboard_post_init_user(void) {
    print("Keyboard initialized\n");
}
```

## カスタマイズ手順

### 1. キーマップの変更
```bash
# 新しいキーマップを作成
qmk new-keymap -kb 36_procyon_bwrs1/guitar_procyon36 -km my_keymap

# キーマップを編集
code keyboards/36_procyon_bwrs1/guitar_procyon36/keymaps/my_keymap/keymap.c
```

### 2. 設定の変更
```bash
# config.hを編集
code keyboards/36_procyon_bwrs1/guitar_procyon36/config.h

# rules.mkを編集
code keyboards/36_procyon_bwrs1/guitar_procyon36/rules.mk
```

### 3. カスタムファームウェアのビルド
```bash
# カスタムキーマップでビルド
qmk compile -kb 36_procyon_bwrs1/guitar_procyon36 -km my_keymap
```

## 参考資料

### 公式ドキュメント
- [QMK公式ドキュメント](https://docs.qmk.fm/)
- [QMK GitHub](https://github.com/qmk/qmk_firmware)
- [QMK Discord](https://discord.gg/Uq7gcHh)

### コミュニティ
- [QMK Reddit](https://www.reddit.com/r/olkb/)
- [QMK GitHub Issues](https://github.com/qmk/qmk_firmware/issues)

### チュートリアル
- [QMK入門ガイド](https://docs.qmk.fm/#/newbs)
- [キーマップ作成ガイド](https://docs.qmk.fm/#/keymap)

---

**作成日**: 2025年8月4日  
**バージョン**: 1.0  
**作成者**: QMK Firmware 